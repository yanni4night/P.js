<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>P.js Demo</title>
    <meta name="keywords" content=""/>
    <meta name="description" content="This is auto-generated by sublime-custom-insert"/>
    <meta name="revised" value="yanni4night,2014/11/30"/>
    <style type="text/css">
    </style>
  </head>
  <body>

  </body>
  <script src="./p.js"></script>
  <script>


    var q = new P(function(resolve,reject){
        setTimeout(resolve.bind(null,'Yes'),2e3);
    });
    var s1=P.all([true,3,4,q]).then(function(data){
        console.assert(Array.isArray(data),'data must be an array');
        console.assert(data[3]==='Yes','Promise wrapper');
        return data.slice(1);
    },function(err){
        console.error(err,'some is rejected');
    }).then(function(data){
        console.assert(3 === data.length,'data lost an element');
        return 23;
    }).then(function(data){
        console.assert(23 === data,'data is 23')
        console.debug('Chain then done');
        return data;
    });

    new P(function(resolve,reject){
        setTimeout(function(){
            reject(new Error('timeout error'));
        },1e3);
    }).catch(function(err){
        console.assert(err&&err.message === 'timeout error','throw an error');
        return 34;
    }).then(function(data){
        console.assert(34 === data,'then get from catch')
        console.debug('Chain catch done');
    });
  </script>
</html>
